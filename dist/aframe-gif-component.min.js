!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var s=i(1);if("undefined"==typeof AFRAME)throw"Component attempted to register before AFRAME was available.";AFRAME.registerComponent("gif",{dependencies:["draw"],schema:{src:{"default":null},autoplay:{"default":!0}},init:function(){var t=this.el.components.draw;return t?(this.__cnv=t.canvas,this.__ctx=t.ctx,this.__texture=t.texture,this.__width=t.data.width,this.__height=t.data.width,void this.__reset()):void console.error("draw component is required as dependencies.\n",this.el)},update:function(t){t?t.src!==this.data.src&&(this.__reset(),this.__load()):this.__load()},remove:function(){this.__clearCanvas(),this.__reset()},tick:function(t){this.__frames&&!this.__paused&&Date.now()-this.__startTime>=this.__nextFrameTime&&this.nextFrame()},pause:function(){this.__paused=!0},play:function(){this.__paused=!1},togglePlayback:function(){this.paused()?this.play():this.pause()},paused:function(){return this.__paused},nextFrame:function(){for(this.__draw();Date.now()-this.__startTime>=this.__nextFrameTime;)this.__nextFrameTime+=this.__delayTimes[this.__frameIdx++],(this.__infinity||this.__loopCnt)&&this.__frameCnt<=this.__frameIdx&&(this.__frameIdx=0)},__clearCanvas:function(){this.__ctx.clearRect(0,0,this.__width,this.__height),this.__texture.needsUpdate=!0},__draw:function(){this.__ctx.drawImage(this.__frames[this.__frameIdx],0,0,this.__width,this.__height),this.__texture.needsUpdate=!0},__load:function(){return this.data.src?void(0,s.loadGIF)(this.data.src,this.__onLoadSuccess.bind(this),this.__onLoadError.bind(this)):void this.__clearCanvas()},__onLoadSuccess:function(t,e,i){this.__delayTimes=t,e?this.__loopCnt=e:this.__infinity=!0,this.__frames=i,this.__frameCnt=t.length,this.__startTime=Date.now(),this.__width=THREE.Math.nearestPowerOfTwo(i[0].width),this.__height=THREE.Math.nearestPowerOfTwo(i[0].height),this.__cnv.width=this.__width,this.__cnv.height=this.__height,this.el.sceneEl.addBehavior(this),this.__draw(),this.data.autoplay?this.play():this.pause()},__onLoadError:function(t){console.log(t)},__reset:function(){this.pause(),this.__startTime=0,this.__nextFrameTime=0,this.__frameIdx=0,this.__frameCnt=0,this.__delayTimes=null,this.__infinity=!1,this.__loopCnt=0,this.__frames=null}})},function(t,e){"use strict";function i(t,e,i){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="arraybuffer",n.onload=function(t){s(new Uint8Array(t.target.response),e,i)},n.onerror=function(){i&&i("loadGIF: load error")},n.send()}function s(t,e,i){var s=0,n=[],a=0,_=null,r=null,h=[],o=0;if(71===t[0]&&73===t[1]&&70===t[2]&&56===t[3]&&57===t[4]&&97===t[5]){s+=13+ +!!(128&t[10])*Math.pow(2,(7&t[10])+1)*3;for(var d=t.subarray(0,s);t[s]&&59!==t[s];){var u=s,c=t[s];if(33===c){var f=t[++s];if(-1===[1,254,249,255].indexOf(f)){i&&i("parseGIF: unknown label");break}for(249===f&&n.push(10*(t[s+3]+(t[s+4]<<8))),255===f&&(o=t[s+15]+(t[s+16]<<8));t[++s];)s+=t[s];249===f&&(_=t.subarray(u,s+1))}else{if(44!==c){i&&i("parseGIF: unknown blockId");break}for(s+=9,s+=1+ +!!(128&t[s])*(3*Math.pow(2,(7&t[s])+1));t[++s];)s+=t[s];var r=t.subarray(u,s+1);h.push(URL.createObjectURL(new Blob([d,_,r])))}s++}}else i&&i("parseGIF: no GIF89a");if(h.length){var l=document.createElement("canvas"),p=function(){h.forEach(function(t,e){var i=new Image;i.onload=function(t,e){0===e&&(l.width=i.width,l.height=i.height),a++,h[e]=this,a===h.length&&(a=0,m(1))}.bind(i,null,e),i.src=t})},m=function w(t){var i=new Image;i.onload=function(t,i){a++,h[i]=this,a===h.length?(l=null,e&&e(n,o,h)):w(++i)}.bind(i),i.src=l.toDataURL("image/gif")};p()}}e.loadGIF=i}]);